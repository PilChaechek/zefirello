План реализации: Управление проектами

Шаг 1: Бэкенд — Фундамент (База данных и Модели)

1. Миграция для `projects`:
    * Создать таблицу projects с полями: id, name (название), slug (уникальный для URL), description (описание).

2. Миграция для `project_user`:
    * Создать связующую таблицу project_user с полями: project_id и user_id. Это стандартная реализация связи "многие-ко-многим".

3. Модели Eloquent:
    * В модели Project определить связь belongsToMany(User::class).
    * В модели User определить связь belongsToMany(Project::class).

Шаг 2: Бэкенд — Логика и API

1. `ProjectController`:
    * Создать контроллер для управления логикой проектов.

2. API-маршруты (`routes/api.php`):
    * POST /api/v1/projects — Создание нового проекта (доступно только админу).
    * GET /api/v1/projects — Получение списка проектов. Для админа — все проекты; для обычного пользователя — только те, в которых он состоит.
    * GET /api/v1/projects/{project:slug} — Получение одного проекта. Доступно только участникам проекта.
    * POST /api/v1/projects/{project:slug}/users — Добавление пользователя в проект (доступно только админу).
    * DELETE /api/v1/projects/{project:slug}/users/{user} — Удаление пользователя из проекта (доступно только админу).

3. Безопасность (`ProjectPolicy`):
    * Создать ProjectPolicy для управления доступами.
    * `viewAny`: Админ видит все, остальные — только свои.
    * `view`: Пользователь должен быть участником проекта.
    * `create`, `update`, `delete`, `manageUsers`: Разрешить только пользователям с ролью 'admin'.

Шаг 3: Фронтенд — Основной интерфейс

1. Роутинг (`vue-router`):
    * '/projects' — новая страница для отображения списка проектов.
    * '/projects/:slug' — страница для отображения деталей конкретного проекта (здесь в будущем будут задачи).

2. Компоненты:
    * `ProjectIndexView.vue`:
        * Страница, которая делает запрос на GET /api/v1/projects и отображает проекты в виде карточек или списка.
        * На ней будет кнопка "Создать проект", видимая только для админа.
    * `ProjectCreateDialog.vue`:
        * Модальное окно с формой для создания нового проекта (поля: name, description).
    * `ProjectDetailView.vue`:
        * Страница, которая делает запрос на GET /api/v1/projects/{slug}.
        * Пока что на ней будет отображаться только название и описание проекта. Это место будет зарезервировано для будущего списка задач.

Шаг 4: Фронтенд — Управление пользователями в проекте

1. Компонент `ProjectUserManagement.vue`:
    * Этот компонент будет находиться на странице ProjectDetailView.vue и будет виден только админу.
    * Функционал:
        * Отображение списка пользователей, которые уже добавлены в проект.
        * Кнопка "Удалить" напротив каждого пользователя для его исключения из проекта.
        * Форма (например, выпадающий список с поиском) для выбора и добавления новых пользователей в проект.

Этот план позволит нам создать полностью рабочую систему управления проектами и доступами, которая станет идеальной основой для добавления задач на следующем этапе.

---
✦ Конечно. Отличная идея — зафиксировать план.

Сегодня мы проделали огромную работу и заложили весь бэкенд-фундамент для проектов. Вот что у нас готово:
* База данных: Созданы и применены миграции для projects и project_user.
* Модели: Настроены модели Project и User со связями "многие-ко-многим".
* Безопасность: Создана и зарегистрирована ProjectPolicy с правилами доступа.
* API: Определены все необходимые API-маршруты в routes/api.php.
* Фронтенд: Настроен роутинг и созданы пустые Vue-компоненты-заглушки.

  ---

План на завтра: "Оживление" функционала проектов

Вот оставшиеся шаги, чтобы полностью реализовать управление проектами:

Шаг 1: Реализовать логику в ProjectController (Бэкенд)

Это наш главный приоритет. Нужно наполнить пустые методы в app/Http/Controllers/Api/V1/Project/ProjectController.php.

1. `store` (Создание проекта):
    * Реализовать валидацию входящих данных (name, description).
    * Автоматически генерировать slug из названия.
    * Применять ProjectPolicy ($this->authorize('create', Project::class)).
    * Создавать проект в базе данных.
2. `index` (Список проектов):
    * Реализовать логику, которая вернет либо все проекты (для админа), либо только проекты пользователя, используя ProjectPolicy.
3. `show` (Один проект):
    * Найти проект по slug.
    * Применить ProjectPolicy ($this->authorize('view', $project)).
    * Вернуть данные проекта.
4. `addUser` / `removeUser` (Управление пользователями):
    * Реализовать логику для добавления/удаления связи в таблице project_user.
    * Защитить эти методы с помощью ProjectPolicy.

Шаг 2: Интеграция и UI на фронтенде

Когда бэкенд будет готов отдавать и принимать данные, мы "оживим" наши Vue-компоненты.

1. `ProjectIndexView.vue` (Страница списка проектов):
    * Сделать API-запрос на GET /api/v1/projects при загрузке страницы.
    * Отобразить полученный список проектов (например, в виде карточек).
    * Интегрировать ProjectFormDialog.vue: по клику на кнопку "Создать проект" (видимую только админу) будет открываться эта модалка.
2. `ProjectFormDialog.vue`:
    * Реализовать отправку формы на POST /api/v1/projects.
    * После успешного создания проекта — закрывать модалку и обновлять список проектов на главной странице.
3. `ProjectDetailView.vue` (Страница проекта):
    * Сделать API-запрос на GET /api/v1/projects/{slug}.
    * Отобразить название и описание проекта.
    * (Для админа): Реализовать UI для управления пользователями (список, форма добавления, кнопка удаления), который будет использовать API-методы addUser и
      removeUser.

Шаг 3: Финальная полировка

1. Типизация: Создать тип Project в TypeScript (resources/js/types/project.ts) и использовать его в компонентах.
2. Навигация: Добавить ссылку на страницу "Проекты" в боковое меню (AppSidebar.vue).

Этот план приведет нас к полностью рабочей системе управления проектами. Отличного отдыха, продолжим завтра
